<?xml version="1.0" encoding="utf-8"?>
<Workflow>
  <WorkflowInfo Name="Switch to DRP" Description="This process is shutting down a list of servers and turns on another list using MAC addresses" Details="&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.0 Transitional//EN&quot;&gt;&#xD;&#xA;&lt;HTML&gt;&lt;HEAD&gt;&#xD;&#xA;&lt;META content=&quot;text/html; charset=unicode&quot; http-equiv=Content-Type&gt;&#xD;&#xA;&lt;META name=GENERATOR content=&quot;MSHTML 9.00.8112.16434&quot;&gt;&lt;/HEAD&gt;&#xD;&#xA;&lt;BODY&gt;&lt;SPAN &#xD;&#xA;style=&quot;LINE-HEIGHT: 115%; FONT-FAMILY: 'Calibri','sans-serif'; FONT-SIZE: 11pt; mso-fareast-font-family: Calibri; mso-bidi-font-family: Arial; mso-ansi-language: EN-US; mso-fareast-language: EN-US; mso-bidi-language: HE&quot;&gt;This &#xD;&#xA;process turns off a list of servers, starts another list of servers in a reverse &#xD;&#xA;order.&lt;/SPAN&gt;&lt;/BODY&gt;&lt;/HTML&gt;&#xD;&#xA;" XML="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;SequentialWorkflowActivity x:Name=&quot;CustomWorkflow&quot; xmlns:ns0=&quot;clr-namespace:SendEmail;Assembly=SendEmail, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns1=&quot;clr-namespace:CreateMemoryTable;Assembly=CreateMemoryTable, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns2=&quot;clr-namespace:GetRowsCount;Assembly=GetRowsCount, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns3=&quot;clr-namespace:Wait;Assembly=Wait, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns4=&quot;clr-namespace:ExitWhile;Assembly=ExitWhile, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns5=&quot;clr-namespace:GetCellValue;Assembly=GetCellValue, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns6=&quot;clr-namespace:ServerShutdown;Assembly=ServerShutdown, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:ns7=&quot;clr-namespace:WakeOnLan;Assembly=WakeOnLan, Version=2.0.0.0, Culture=neutral, PublicKeyToken=null&quot; xmlns:x=&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot; xmlns=&quot;http://schemas.microsoft.com/winfx/2006/xaml/workflow&quot; x:Class=&quot;WorkflowDesignerControl.CustomWorkflow&quot;&gt;&lt;ns0:SendEmail Channel=&quot;0&quot; TimeInSeconds=&quot;0&quot; Subject=&quot;Starting switch to DRP process&quot; DestinationNumber=&quot;1&quot; x:Name=&quot;sendEmail1&quot; TemplateNumber=&quot;0&quot; ShiftLevel=&quot;&quot; IsValid=&quot;True&quot; HostId=&quot;-2&quot; TemplateName=&quot;&quot; TypeName=&quot;SendEmail&quot; SendRN=&quot;False&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; DestinationTypeCc=&quot;User&quot; DestinationType=&quot;User&quot; HostName=&quot;{x:Null}&quot; Timeout=&quot;00:00:00&quot; DisplayName=&quot;Send Email&quot; Attachments=&quot;&quot; Cc=&quot;&quot; Description=&quot;Send an email to a user, a group or a duty.&quot; Continue=&quot;False&quot; DestinationNumberCc=&quot;0&quot; Body=&quot;&amp;lt;!DOCTYPE HTML PUBLIC &amp;quot;-//W3C//DTD HTML 4.0 Transitional//EN&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;HTML&amp;gt;&amp;lt;HEAD&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;META content=&amp;quot;text/html; charset=utf-8&amp;quot; http-equiv=Content-Type&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;META name=GENERATOR content=&amp;quot;MSHTML 11.00.9600.16476&amp;quot;&amp;gt;&amp;lt;/HEAD&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;BODY style=&amp;quot;BACKGROUND-COLOR: white&amp;quot;&amp;gt;&amp;lt;FONT face=Arial&amp;gt;Starting switch to DRP &amp;#xD;&amp;#xA;process - Shutting down servers.&amp;lt;/FONT&amp;gt; &amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;&amp;#xD;&amp;#xA;&quot; To=&quot;Admin&quot; ShiftLevelCc=&quot;&quot; MessageType=&quot;Custom&quot; /&gt;&lt;ns1:CreateMemoryTable IsValid=&quot;True&quot; x:Name=&quot;createMemoryTable1&quot; ColumnNumber=&quot;1&quot; TableName=&quot;ShutdownList&quot; RowNumber=&quot;4&quot; isEmptyGrid=&quot;0&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Description=&quot;Creates a memory table.&quot; DisplayName=&quot;Create Memory Table&quot; TypeName=&quot;CreateMemoryTable&quot; TableAsString=&quot;&amp;lt;NewDataSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;xs:schema id=&amp;quot;NewDataSet&amp;quot; xmlns=&amp;quot;&amp;quot; xmlns:xs=&amp;quot;http://www.w3.org/2001/XMLSchema&amp;quot; xmlns:msdata=&amp;quot;urn:schemas-microsoft-com:xml-msdata&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;xs:element name=&amp;quot;NewDataSet&amp;quot; msdata:IsDataSet=&amp;quot;true&amp;quot; msdata:MainDataTable=&amp;quot;resultSet&amp;quot; msdata:UseCurrentLocale=&amp;quot;true&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;      &amp;lt;xs:complexType&amp;gt;&amp;#xD;&amp;#xA;        &amp;lt;xs:choice minOccurs=&amp;quot;0&amp;quot; maxOccurs=&amp;quot;unbounded&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;          &amp;lt;xs:element name=&amp;quot;resultSet&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;            &amp;lt;xs:complexType&amp;gt;&amp;#xD;&amp;#xA;              &amp;lt;xs:sequence&amp;gt;&amp;#xD;&amp;#xA;                &amp;lt;xs:element name=&amp;quot;ServerName&amp;quot; type=&amp;quot;xs:string&amp;quot; minOccurs=&amp;quot;0&amp;quot; /&amp;gt;&amp;#xD;&amp;#xA;              &amp;lt;/xs:sequence&amp;gt;&amp;#xD;&amp;#xA;            &amp;lt;/xs:complexType&amp;gt;&amp;#xD;&amp;#xA;          &amp;lt;/xs:element&amp;gt;&amp;#xD;&amp;#xA;        &amp;lt;/xs:choice&amp;gt;&amp;#xD;&amp;#xA;      &amp;lt;/xs:complexType&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;/xs:element&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/xs:schema&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;Backup-SRV1&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;SQL-SRV1&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;Exchange-SRV1&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;DomainController-SRV1&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;/NewDataSet&amp;gt;&quot; /&gt;&lt;ns2:GetRowsCount IsValid=&quot;True&quot; x:Name=&quot;getRowsCount1&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; ResultSet=&quot;%ShutdownList%&quot; DisplayName=&quot;Get Rows Count&quot; ResultSetName=&quot;ShutdownList&quot; Description=&quot;Gets the amount of rows in a resultset.&quot; TypeName=&quot;GetRowsCount&quot; /&gt;&lt;WhileActivity x:Name=&quot;whileActivity2&quot; Condition=&quot;{x:Null}&quot;&gt;&lt;SequenceActivity x:Name=&quot;sequenceActivity2&quot;&gt;&lt;ns4:ExitWhile IsValid=&quot;True&quot; x:Name=&quot;exitWhile1&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Counter=&quot;%getRowsCount1%&quot; Description=&quot;Exit current while activity&quot; DisplayName=&quot;Exit While&quot; TypeName=&quot;ExitWhile&quot; /&gt;&lt;ns5:GetCellValue ColumnType=&quot;Number&quot; IsValid=&quot;True&quot; x:Name=&quot;ServerName&quot; ColumnNumber=&quot;1&quot; ResultSet=&quot;%ShutdownList%&quot; RowNumber=&quot;%exitWhile1%&quot; ResultSetName=&quot;ShutdownList&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Description=&quot;Gets a specific cell value from a resultset.&quot; DisplayName=&quot;Get Cell Value&quot; TypeName=&quot;GetCellValue&quot; /&gt;&lt;ns6:ServerShutdown IsValid=&quot;True&quot; x:Name=&quot;serverShutdown1&quot; HostName=&quot;%ServerName%&quot; TimeInSeconds=&quot;0&quot; Timeout=&quot;00:01:00&quot; ActionTypeList=&quot;Forced,Normal&quot; ActionType=&quot;Forced&quot; DisplayName=&quot;Server Shutdown&quot; Password=&quot;&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Description=&quot;Shutdown the selected server&quot; HostId=&quot;-2&quot; TypeName=&quot;ServerShutdown&quot; UserName=&quot;&quot; /&gt;&lt;/SequenceActivity&gt;&lt;/WhileActivity&gt;&lt;ns3:Wait IsValid=&quot;True&quot; x:Name=&quot;wait1&quot; TimeInterval=&quot;&quot; isDefault=&quot;0&quot; DisplayName=&quot;Wait&quot; TimeInSeconds=&quot;600&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Description=&quot;Pause workflow&quot; TypeName=&quot;Wait&quot; TimeValue=&quot;&quot; Timeout=&quot;00:10:00&quot; /&gt;&lt;ns0:SendEmail Channel=&quot;0&quot; TimeInSeconds=&quot;0&quot; Subject=&quot;Switch to DRP process&quot; DestinationNumber=&quot;1&quot; x:Name=&quot;sendEmail2&quot; TemplateNumber=&quot;0&quot; ShiftLevel=&quot;&quot; IsValid=&quot;True&quot; HostId=&quot;-2&quot; TemplateName=&quot;&quot; TypeName=&quot;SendEmail&quot; SendRN=&quot;False&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; DestinationTypeCc=&quot;User&quot; DestinationType=&quot;User&quot; HostName=&quot;{x:Null}&quot; Timeout=&quot;00:00:00&quot; DisplayName=&quot;Send Email&quot; Attachments=&quot;&quot; Cc=&quot;&quot; Description=&quot;Send an email to a user, a group or a duty.&quot; Continue=&quot;False&quot; DestinationNumberCc=&quot;0&quot; Body=&quot;&amp;lt;!DOCTYPE HTML PUBLIC &amp;quot;-//W3C//DTD HTML 4.0 Transitional//EN&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;HTML&amp;gt;&amp;lt;HEAD&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;META content=&amp;quot;text/html; charset=utf-8&amp;quot; http-equiv=Content-Type&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;META name=GENERATOR content=&amp;quot;MSHTML 11.00.9600.16476&amp;quot;&amp;gt;&amp;lt;/HEAD&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;BODY style=&amp;quot;BACKGROUND-COLOR: white&amp;quot;&amp;gt;&amp;lt;FONT face=Arial&amp;gt;Switch to DRP process - &amp;#xD;&amp;#xA;Starting servers.&amp;lt;/FONT&amp;gt; &amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;&amp;#xD;&amp;#xA;&quot; To=&quot;Admin&quot; ShiftLevelCc=&quot;&quot; MessageType=&quot;Custom&quot; /&gt;&lt;ns1:CreateMemoryTable IsValid=&quot;True&quot; x:Name=&quot;createMemoryTable2&quot; ColumnNumber=&quot;2&quot; TableName=&quot;StartupList&quot; RowNumber=&quot;4&quot; isEmptyGrid=&quot;0&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Description=&quot;Creates a memory table.&quot; DisplayName=&quot;Create Memory Table&quot; TypeName=&quot;CreateMemoryTable&quot; TableAsString=&quot;&amp;lt;NewDataSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;xs:schema id=&amp;quot;NewDataSet&amp;quot; xmlns=&amp;quot;&amp;quot; xmlns:xs=&amp;quot;http://www.w3.org/2001/XMLSchema&amp;quot; xmlns:msdata=&amp;quot;urn:schemas-microsoft-com:xml-msdata&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;xs:element name=&amp;quot;NewDataSet&amp;quot; msdata:IsDataSet=&amp;quot;true&amp;quot; msdata:MainDataTable=&amp;quot;resultSet&amp;quot; msdata:UseCurrentLocale=&amp;quot;true&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;      &amp;lt;xs:complexType&amp;gt;&amp;#xD;&amp;#xA;        &amp;lt;xs:choice minOccurs=&amp;quot;0&amp;quot; maxOccurs=&amp;quot;unbounded&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;          &amp;lt;xs:element name=&amp;quot;resultSet&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;            &amp;lt;xs:complexType&amp;gt;&amp;#xD;&amp;#xA;              &amp;lt;xs:sequence&amp;gt;&amp;#xD;&amp;#xA;                &amp;lt;xs:element name=&amp;quot;ServerName&amp;quot; type=&amp;quot;xs:string&amp;quot; minOccurs=&amp;quot;0&amp;quot; /&amp;gt;&amp;#xD;&amp;#xA;                &amp;lt;xs:element name=&amp;quot;MAC&amp;quot; type=&amp;quot;xs:string&amp;quot; minOccurs=&amp;quot;0&amp;quot; /&amp;gt;&amp;#xD;&amp;#xA;              &amp;lt;/xs:sequence&amp;gt;&amp;#xD;&amp;#xA;            &amp;lt;/xs:complexType&amp;gt;&amp;#xD;&amp;#xA;          &amp;lt;/xs:element&amp;gt;&amp;#xD;&amp;#xA;        &amp;lt;/xs:choice&amp;gt;&amp;#xD;&amp;#xA;      &amp;lt;/xs:complexType&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;/xs:element&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/xs:schema&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;DomainController-SRV2&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;MAC&amp;gt;00-00-00-00-00-00-00-E0&amp;lt;/MAC&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;Exchange-SRV2&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;MAC&amp;gt;00-00-00-00-00-00-00-E1&amp;lt;/MAC&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;SQL-SRV2&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;MAC&amp;gt;00-00-00-00-00-00-00-E2&amp;lt;/MAC&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;resultSet&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;ServerName&amp;gt;Backup-SRV2&amp;lt;/ServerName&amp;gt;&amp;#xD;&amp;#xA;    &amp;lt;MAC&amp;gt;00-00-00-00-00-00-00-E3&amp;lt;/MAC&amp;gt;&amp;#xD;&amp;#xA;  &amp;lt;/resultSet&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;/NewDataSet&amp;gt;&quot; /&gt;&lt;ns2:GetRowsCount IsValid=&quot;True&quot; x:Name=&quot;getRowsCount2&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; ResultSet=&quot;%StartupList%&quot; DisplayName=&quot;Get Rows Count&quot; ResultSetName=&quot;StartupList&quot; Description=&quot;Gets the amount of rows in a resultset.&quot; TypeName=&quot;GetRowsCount&quot; /&gt;&lt;WhileActivity x:Name=&quot;whileActivity1&quot; Condition=&quot;{x:Null}&quot;&gt;&lt;SequenceActivity x:Name=&quot;sequenceActivity1&quot;&gt;&lt;ns4:ExitWhile IsValid=&quot;True&quot; x:Name=&quot;exitWhile2&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Counter=&quot;%getRowsCount2%&quot; Description=&quot;Exit current while activity&quot; DisplayName=&quot;Exit While&quot; TypeName=&quot;ExitWhile&quot; /&gt;&lt;ns5:GetCellValue ColumnType=&quot;Number&quot; IsValid=&quot;True&quot; x:Name=&quot;MAC_Address&quot; ColumnNumber=&quot;2&quot; ResultSet=&quot;%StartupList%&quot; RowNumber=&quot;%exitWhile2%&quot; ResultSetName=&quot;StartupList&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; Description=&quot;Gets a specific cell value from a resultset.&quot; DisplayName=&quot;Get Cell Value&quot; TypeName=&quot;GetCellValue&quot; /&gt;&lt;ns7:WakeOnLan IsValid=&quot;True&quot; x:Name=&quot;wakeOnLan1&quot; HostName=&quot;{x:Null}&quot; Timeout=&quot;00:00:00&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; DisplayName=&quot;Wake on Lan&quot; MacAddress=&quot;%MAC_Address%&quot; TimeInSeconds=&quot;0&quot; SendMulticast=&quot;True&quot; Description=&quot;Sends a wake on lan magic packet to a specified mac address.&quot; HostId=&quot;0&quot; TypeName=&quot;WakeOnLan&quot; VariableType=&quot;2&quot; /&gt;&lt;/SequenceActivity&gt;&lt;/WhileActivity&gt;&lt;ns0:SendEmail Channel=&quot;0&quot; TimeInSeconds=&quot;0&quot; Subject=&quot;Switch to DRP process is completed&quot; DestinationNumber=&quot;1&quot; x:Name=&quot;sendEmail3&quot; TemplateNumber=&quot;0&quot; ShiftLevel=&quot;&quot; IsValid=&quot;True&quot; HostId=&quot;-2&quot; TemplateName=&quot;&quot; TypeName=&quot;SendEmail&quot; SendRN=&quot;False&quot; RecoveryMethodSelection=&quot;{x:Null}&quot; DestinationTypeCc=&quot;User&quot; DestinationType=&quot;User&quot; HostName=&quot;{x:Null}&quot; Timeout=&quot;00:00:00&quot; DisplayName=&quot;Send Email&quot; Attachments=&quot;&quot; Cc=&quot;&quot; Description=&quot;Send an email to a user, a group or a duty.&quot; Continue=&quot;False&quot; DestinationNumberCc=&quot;0&quot; Body=&quot;&amp;lt;!DOCTYPE HTML PUBLIC &amp;quot;-//W3C//DTD HTML 4.0 Transitional//EN&amp;quot;&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;HTML&amp;gt;&amp;lt;HEAD&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;META content=&amp;quot;text/html; charset=utf-8&amp;quot; http-equiv=Content-Type&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;META name=GENERATOR content=&amp;quot;MSHTML 11.00.9600.16476&amp;quot;&amp;gt;&amp;lt;/HEAD&amp;gt;&amp;#xD;&amp;#xA;&amp;lt;BODY style=&amp;quot;BACKGROUND-COLOR: white&amp;quot;&amp;gt;&amp;lt;FONT face=Arial&amp;gt;Switch to DRP process is &amp;#xD;&amp;#xA;completed.&amp;lt;/FONT&amp;gt; &amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;&amp;#xD;&amp;#xA;&quot; To=&quot;Admin&quot; ShiftLevelCc=&quot;&quot; MessageType=&quot;Custom&quot; /&gt;&lt;/SequentialWorkflowActivity&gt;" />
  <Tags>
    <Tag id="62" name="System">
    </Tag>
  </Tags>
</Workflow>